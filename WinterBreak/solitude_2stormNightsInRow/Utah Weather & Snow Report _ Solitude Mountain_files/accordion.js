define("accordion",function(require){"use strict";var $=require("jquery");var helpers=require("helpers");var ResponsiveTable=require("ResponsiveTable");var defaults={root:null,groupSelector:".accordion-group",titleSelector:".accordion-title",itemsSelector:".accordion-items",icon:".icon",onNeedsHeight:null,startsOpen:false,isAccordion:false};function create(options){var accordion={};accordion.options=$.extend({},defaults,options);var accordionGroup=options.root.closest(defaults.groupSelector)[0];accordion.config=accordionGroup?JSON.parse($.attr(accordionGroup,"data-config")):{};accordion.activeIcon=accordion.config.ActiveIcon;accordion.inactiveIcon=accordion.config.InactiveIcon;var iconConfigData=accordion.options.root[0].hasAttribute("data-config")?JSON.parse($.attr(accordion.options.root[0],"data-config")):null;if(iconConfigData!=null&&iconConfigData.UseCustomIcons){accordion.activeIcon=iconConfigData.ActiveIcon;accordion.inactiveIcon=iconConfigData.InactiveIcon}accordion.options.root[0].addEventListener("redrawicon",function(event){accordion.options.root.find(".icon").removeClass(accordion.activeIcon);if(accordion.inactiveIcon){accordion.options.root.find(".icon").addClass(accordion.inactiveIcon)}});bind(accordion);accordion.init();return accordion}function bind(accordion){accordion.init=init.bind(accordion);accordion.attachA11y=attachA11y.bind(accordion);accordion.cacheDom=cacheDom.bind(accordion);accordion.attachEvents=attachEvents.bind(accordion);accordion.titleClick=titleClick.bind(accordion);accordion.setMaxHeight=setMaxHeight.bind(accordion);accordion.resize=resize.bind(accordion);accordion.openFilterOnStart=openFilterOnStart.bind(accordion);accordion.openByDefaultOnStart=openByDefaultOnStart.bind(accordion);accordion.onHashChange=onHashChange.bind(accordion);accordion.toggleAccordionItem=toggleAccordionItem.bind(accordion);accordion.openAccordionItem=openAccordionItem.bind(accordion);accordion.closeAccordionItem=closeAccordionItem.bind(accordion);accordion.resetAccordionItems=resetAccordionItems.bind(accordion);accordion.getAccordionHashName=getAccordionHashName.bind(accordion);accordion.detachA11y=detachA11y.bind(accordion);accordion.detachEvents=detachEvents.bind(accordion);accordion.detach=detach.bind(accordion);accordion.reattach=reattach.bind(accordion);accordion.setHover=setHover.bind(accordion)}function cacheDom(){this.dom={};this.dom.window=$(window);this.dom.root=this.options.root.addClass("accordion");this.dom.group=this.dom.root.closest(this.options.groupSelector).addClass("accordion-group");this.dom.title=this.dom.root.find(this.options.titleSelector).addClass("accordion-title");this.dom.itemContainer=this.dom.root.find(this.options.itemsSelector).addClass("accordion-items");this.dom.icon=this.dom.root.find(this.options.icon)}function attachA11y(){var itemId=this.dom.itemContainer.attr("id"),titleId=this.dom.title.attr("id");if(!itemId){itemId="accord-item-"+helpers.generateGuid();this.dom.itemContainer.attr("id",itemId)}if(!titleId){titleId="accord-title-"+helpers.generateGuid();this.dom.title.attr("id",titleId)}this.dom.title.attr({"aria-expanded":this.options.startsOpen,"aria-controls":itemId,tabindex:"0"});this.dom.itemContainer.attr({"aria-labelledby":titleId,"aria-hidden":"true"});if(this.dom.group.length>0){this.dom.group.attr("role","tablist");this.dom.title.attr("role","tab");this.dom.itemContainer.attr("role","tabpanel")}}function detachA11y(){this.dom.title.removeAttr("aria-expanded").removeAttr("aria-controls");this.dom.itemContainer.removeAttr("aria-labelledby").removeAttr("aria-hidden")}function attachEvents(){if(!this.debouncedResize){this.debouncedResize=helpers.debounce(this.resize,100,false)}this.dom.title.on("click keyup",this.titleClick);this.dom.window.on("resize",this.debouncedResize);this.dom.window.on("hashchange",this.onHashChange)}function detachEvents(){this.dom.title.off("click keyup",this.titleClick);this.dom.window.off("resize",this.debouncedResize);this.dom.window.off("hashchange",this.onHashChange)}function titleClick(e){if(helpers.a11yClick(e)===true){this.toggleAccordionItem()}}function toggleAccordionItem(){if(this.dom.root.hasClass("open")){this.closeAccordionItem()}else{this.openAccordionItem()}}function resetAccordionItems(){if(this.options.isAccordion&&this.dom.group.length>0){this.dom.group.find(".accordion-title").attr("aria-expanded","false");this.dom.group.find(".accordion-items").css("height",0).attr("aria-hidden","true");this.dom.group.find(".accordion").removeClass("open")}this.dom.title.removeAttr("aria-expanded");this.dom.itemContainer.css("height","").removeAttr("aria-hidden");this.dom.root.removeClass("open");this.dom.window.trigger("changingPageHeight")}function closeAccordionItem(){this.dom.title.attr("aria-expanded","false");this.dom.itemContainer.css("height","0").attr("aria-hidden","true");this.dom.root.removeClass("open");this.dom.title.css("background-color","");this.dom.icon.removeClass(this.activeIcon);if(this.inactiveIcon){this.dom.icon.addClass(this.inactiveIcon)}this.dom.window.trigger("changingPageHeight")}function openAccordionItem(){if(this.options.isAccordion&&this.dom.group.length>0){this.dom.group.find(".accordion-title").attr("aria-expanded","false");this.dom.group.find(".accordion-items").css("height",0).attr("aria-hidden","true");this.dom.group.find(".accordion").removeClass("open");this.dom.group.find(".accordion").each(function(){$(this)[0].dispatchEvent(new CustomEvent("redrawicon",{detail:{name:"redrawicon"}}))})}this.setMaxHeight();this.dom.root.addClass("open");this.dom.title.off("mouseleave");this.dom.title.css("background-color","");if(this.activeIcon){this.dom.icon.removeClass(this.inactiveIcon);this.dom.icon.addClass(this.activeIcon)}this.dom.title.attr("aria-expanded","true");this.dom.itemContainer.attr("aria-hidden","false");this.dom.window.trigger("changingPageHeight")}function getInvisibleElementHeight(element){var renderedStyle=getComputedStyle(element);var height=parseFloat(renderedStyle.paddingTop)+parseFloat(renderedStyle.paddingBottom);for(var i=0;i<element.children.length;i++){var itemRenderedStyle=getComputedStyle(element.children[i]);height+=parseFloat(itemRenderedStyle.height);height+=parseFloat(itemRenderedStyle.marginTop);height+=parseFloat(itemRenderedStyle.marginBottom);height+=parseFloat(itemRenderedStyle.paddingTop);height+=parseFloat(itemRenderedStyle.paddingBottom)}return height}function setMaxHeight(){var maxHeight=this.options.onNeedsHeight?this.options.onNeedsHeight(this.dom.itemContainer[0]):getInvisibleElementHeight(this.dom.itemContainer[0]);if(this.dom.itemContainer.length){this.dom.itemContainer[0].style.height=maxHeight+"px"}}function resize(){if(this.dom.root.hasClass("open")){this.setMaxHeight()}}function onHashChange(){var self=this,thisHashName=self.getAccordionHashName(),accordionHash=helpers.getHashParameterByName("accordions"),accordionHashArray=accordionHash.split("|");if(accordionHashArray.indexOf(thisHashName)!==-1){self.openAccordionItem()}}function openFilterOnStart(){if(this.options.startsOpen===true&&this.dom.itemContainer.length>0){this.dom.root.addClass("open");this.dom.itemContainer[0].style.transition="none";this.dom.itemContainer[0].style.height="auto";if(this.dom.title.attr("aria-expanded")){this.dom.title.attr("aria-expanded","true")}this.dom.window.trigger("changingPageHeight");var element=this.dom.itemContainer[0],rootElement=this.dom.root;setTimeout(function(){element.style.height=0;element.style.transition="padding-bottom 0.5s, padding-top 0.5s, height 0.5s";rootElement.removeClass("open");this.dom.window.trigger("changingPageHeight")}.bind(this),1e3)}}function openByDefaultOnStart(){if(this.dom.root.hasClass("defaultOpen")){this.dom.root.addClass("open");this.dom.title.off("mouseleave");if(this.activeIcon){this.dom.icon.removeClass(this.inactiveIcon);this.dom.icon.addClass(this.activeIcon)}this.dom.itemContainer[0].style.transition="none";this.dom.itemContainer[0].style.height="auto";if(this.dom.title.attr("aria-expanded")){this.dom.title.attr("aria-expanded","true")}this.dom.window.trigger("changingPageHeight")}}function getAccordionHashName(){return this.dom.title.text().trim().replace(/ /gi,"-").toLowerCase()}function setHover(){this.dom.title.on({mouseenter:function(){},mouseleave:function(){}})}function addResponsiveTables(){if(!helpers.isPageEditor){$(".accordion-body table").each(function(){var responsiveTable=$(this).hasClass("responsive-table")||$(this).hasClass("responsive-table-variation");var spannedTitle=$(this).hasClass("spanned-title-table");if(responsiveTable){return}if($(this).parent().hasClass("rte-table-wrapper")){return}ResponsiveTable.create({root:this,spannedTitle:spannedTitle})})}}function init(){this.cacheDom();this.attachEvents();this.attachA11y();this.setHover();this.openFilterOnStart();this.openByDefaultOnStart();this.onHashChange();addResponsiveTables()}function detach(){this.detachEvents();this.detachA11y();this.resetAccordionItems()}function reattach(){this.attachEvents();this.attachA11y();this.resetAccordionItems()}return{create:create,closeAccordionItem:closeAccordionItem,openAccordionItem:openAccordionItem,detach:detach,reattach:reattach}});