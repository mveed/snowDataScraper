define(function(require){"use strict";var $=require("jquery"),helpers=require("helpers"),openCloseAnimations,headerComponentModel,headerStateManager=require("header-component-manager"),conditionLightbox=require("condition-lightbox-module"),scrollHelper,openClass="opened",dom={};require("slick");var cookieManager=function(){var cookieName;function init(){cookieName=dom.component.data("switchable-stat-system-cookie-name")}function setCookie(system){helpers.setCookie(cookieName,system)}return{init:init,setCookie:setCookie}}();function init(){initDom();attachEventHandlers();resizeProcesses();cookieManager.init();openCloseAnimations=new(require("header-animation"))(dom.dropdown);scrollHelper=new(require("header-dropdown-scroll-helper"))($("body"),dom.dropdown,dom.dropdownScrollContainer);headerComponentModel=new(require("header-component-model"))(dom.dropdown,closeDropdown,isDropdownOpen);headerStateManager.register(headerComponentModel);conditionLightbox.initialize()}function initDom(){dom.component=$(".condition-snippet-wrapper");dom.dropdownToggle=$(".condition-snippet");dom.dropdown=$(".conditions-dropdown");dom.dropdownScrollContainer=dom.component.find(".conditions-dropdown-scroller-inner");dom.carousel=$(".conditions-dropdown-content");dom.unitToggleContainers=$(".metric-toggle");dom.switchableStats=$(".switchable-stat")}function attachEventHandlers(){$(window).on("resize",helpers.debounce(resizeProcesses,10,true));dom.dropdownToggle.on("click",toggleDropdown);attachUnitToggleEventHandlers()}function attachUnitToggleEventHandlers(){$(".metric-toggle-unit").on("click",toggleSwitchableStat)}function resizeProcesses(){initOrDestroyCarousel();applyCarouselWidth()}function initOrDestroyCarousel(){if(helpers.windowWidthsGreaterThan(768)){destroyCarousel()}else{initCarousel()}}function applyCarouselWidth(){dom.carousel.css("width",$(window).width()+"px")}function initCarousel(){if(carouselInitalized()){return}dom.carousel.slick({arrows:false,dots:true,infinite:false,mobileFirst:true,slidesToScroll:1,slidesToShow:1})}function destroyCarousel(){if(!carouselInitalized()){return}dom.carousel.slick("unslick");attachUnitToggleEventHandlers()}function carouselInitalized(){return dom.carousel.hasClass("slick-initialized")}function isDropdownOpen(){return dom.component.hasClass(openClass)}function isOverlayEnabled(){return dom.dropdownToggle.hasClass("overlay-enabled")}function toggleDropdown(){if(isOverlayEnabled()){openOverlay()}else if(isDropdownOpen()){closeDropdown(true)}else{openDropdown()}}function openOverlay(){headerStateManager.closeOtherComponents(headerComponentModel.id,true);conditionLightbox.show();dom.component.addClass(openClass);openCloseAnimations.open(undefined,550)}function openDropdown(){headerStateManager.closeOtherComponents(headerComponentModel.id,false);scrollHelper.dropdownOpened();dom.component.addClass(openClass);openCloseAnimations.open(undefined,550)}function closeDropdown(updateHeaderState){scrollHelper.dropdownClosed();dom.component.removeClass(openClass);openCloseAnimations.close(updateHeaderState,undefined,550)}function toggleSwitchableStat(e){var target=$(e.currentTarget);var activeToggleClass="metric-toggle-unit--active";if(target.hasClass(activeToggleClass)){return}dom.switchableStats.each(function(i,stat){$(stat).find(".switchable-stat-item").each(function(i,m){var metric=$(m);var hiddenClass="d-none";if(metric.hasClass(hiddenClass)){metric.removeClass(hiddenClass)}else{metric.addClass(hiddenClass)}})});dom.unitToggleContainers.each(function(i,container){var $container=$(container);$container.find(".metric-toggle-unit").each(function(i,unitToggle){var $unitToggle=$(unitToggle);if($unitToggle.hasClass(activeToggleClass)){$unitToggle.removeClass(activeToggleClass)}else{$unitToggle.addClass(activeToggleClass)}})});cookieManager.setCookie(target.hasClass("metric-toggle-unit--metric")?"metric":"imperial")}init()});